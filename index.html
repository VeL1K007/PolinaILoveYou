<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <!-- –í–ê–ñ–ù–û –¥–ª—è –º–æ–±–∏–ª—å–Ω–∏–∫–æ–≤ -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>–ù–∞—à –î–µ–Ω—å –†–æ–∂–¥–µ–Ω–∏—è üéÇ‚ù§Ô∏è</title>
  <style>
    /* –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    html, body {
      height: 100%;
      overflow-x: hidden; /* –æ—Ç–∫–ª—é—á–∞–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∫—É */
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(to bottom, #fff0f6, #ffe0ec);
      user-select: none;
      text-align: center;
      padding: 5vh 5vw;
    }

    /* –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞ */
    :root {
      --pink: #e91e63;
      --rose: #ff4081;
      --dark-rose: #880e4f;
      --text: #6a1b9a;
    }

    /* –°–µ—Ä–¥–µ—á–∫–æ */
    #heart-container { margin-bottom: 4vh; }
    #heart {
      font-size: clamp(64px, 20vw, 120px);
      color: var(--pink);
      cursor: pointer;
      animation: pulse 2s infinite;
      display: inline-block;
    }
    @keyframes pulse {
      0%,100% { transform: scale(1); }
      50%     { transform: scale(1.15); }
    }

    /* –ü–∞–¥–∞—é—â–∏–µ —Å–µ—Ä–¥–µ—á–∫–∏ */
    .heart-fall {
      position: fixed;
      font-size: 24px;
      color: var(--rose);
      pointer-events: none;
      will-change: transform, opacity;
      animation: fall 3s ease-out forwards;
      z-index: 10;
    }
    @keyframes fall {
      to {
        transform: translateY(90vh) scale(0.5);
        opacity: 0;
      }
    }

    /* –¢–µ–∫—Å—Ç–æ–≤—ã–µ –±–ª–æ–∫–∏ */
    #hint {
      font-size: clamp(16px,4.5vw,22px);
      color: #ad1457;
      margin-bottom: 2vh;
    }
    #message {
      display: none;
      font-size: clamp(18px,5vw,24px);
      color: #ad1457;
      min-height: 6vh;
      margin: 2vh 0;
    }
    #shared-birthday {
      display: none;
      font-size: clamp(20px,6vw,28px);
      font-weight: bold;
      color: #d81b60;
      margin-top: 3vh;
      animation: fadeIn 2s ease-in-out;
    }
    #timer {
      display: none;
      font-size: clamp(16px,4vw,20px);
      color: var(--dark-rose);
      font-weight: 600;
      margin-top: 2vh;
    }

    /* –ë–ª–æ–∫ —Å –ø–∏—Å—å–º–æ–º */
    #letter-container {
      display: none;
      margin-top: 5vh;
      position: relative;
    }
    #emoji-envelope {
      font-size: clamp(60px,18vw,90px);
      cursor: pointer;
      transition: transform .2s;
    }
    #emoji-envelope:hover {
      transform: scale(1.1);
    }
    #sliding-letter {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 80vw;
      max-width: 300px;
      height: 0;
      overflow: hidden;
      transition: height .8s ease;
    }
    .letter-paper {
      background: #fffafc;
      border: 2px solid var(--pink);
      border-radius: 10px;
      padding: 1.5em;
      font-size: clamp(14px,4vw,18px);
      color: var(--text);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    /* Canvas –ø–æ–¥ —Ñ–µ–π–µ—Ä–≤–µ—Ä–∫–∏ */
    #fireworks-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 0;
      pointer-events: none;
      display: none;
    }

    @keyframes fadeIn {
      from { opacity: 0; } to { opacity: 1; }
    }
  </style>
</head>
<body>

  <div id="heart-container">
    <div id="heart">‚ù§Ô∏è</div>
  </div>
  <div id="hint">–ù–∞–∂–º–∏ –Ω–∞ —Å–µ—Ä–¥–µ—á–∫–æ üòâ</div>
  <div id="shared-birthday">–° –î–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è, –ü–æ–ª–∏–Ω–∞ üíñ</div>
  <div id="message"></div>
  <div id="timer"></div>

  <div id="letter-container">
    <div id="emoji-envelope">üì©</div>
    <div id="sliding-letter">
      <div class="letter-paper">
        –¢—ã –º–æ—ë –≥–ª–∞–≤–Ω–æ–µ —á—É–¥–æ —ç—Ç–æ–≥–æ –¥–Ω—è.<br>
        –Ø —Å—á–∞—Å—Ç–ª–∏–≤, —á—Ç–æ –º—ã —Ä–æ–¥–∏–ª–∏—Å—å –≤ –æ–¥–∏–Ω –¥–µ–Ω—å üíå
      </div>
    </div>
  </div>

  <canvas id="fireworks-canvas"></canvas>

  <script>
    const heart      = document.getElementById('heart');
    const hint       = document.getElementById('hint');
    const birthday   = document.getElementById('shared-birthday');
    const message    = document.getElementById('message');
    const timerEl    = document.getElementById('timer');
    const letterCont = document.getElementById('letter-container');
    const emojiEnv   = document.getElementById('emoji-envelope');
    const sliding    = document.getElementById('sliding-letter');
    const canvas     = document.getElementById('fireworks-canvas');
    const ctx        = canvas.getContext('2d');

    // –§—Ä–∞–∑—ã
    const phrases = [
      "–ü–æ–ª–∏–Ω–∞, —Ç—ã –º–æ—ë —Å–µ—Ä–¥–µ—á–∫–æ! üíå",
      "–° –∫–∞–∂–¥—ã–º –¥–Ω—ë–º —è –≤—Å—ë —Å–∏–ª—å–Ω–µ–µ –≤–ª—é–±–ª—è—é—Å—å –≤ —Ç–µ–±—è üíó",
      "–¢—ã –¥–µ–ª–∞–µ—à—å –º–µ–Ω—è —Å—á–∞—Å—Ç–ª–∏–≤–µ–µ —Å –∫–∞–∂–¥–æ–π –º–∏–Ω—É—Ç–æ–π üíû",
      "–ú—ã –æ–±–∞ —Ä–æ–¥–∏–ª–∏—Å—å –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å ‚Äî —Å—É–¥—å–±–∞ —è–≤–Ω–æ –±—ã–ª–∞ –≤ —É–¥–∞—Ä–µ! üéâ",
      "–õ—é–±–ª—é —Ç–≤–æ–π –≥–æ–ª–æ—Å, —É–ª—ã–±–∫—É –∏ —Ç–≤–æ—ë —Å–µ—Ä–¥–µ—á–∫–æ ‚ù§Ô∏è",
      "–¢—ã ‚Äî –º–æ–π –ø–æ–¥–∞—Ä–æ–∫ –Ω–∞ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è ‚ú®"
    ];

    // –û—Ç—Å—á—ë—Ç —Å –¥–∞—Ç—ã
    const startDate = new Date('2025-05-28T00:00:00');

    function createFallingHeart() {
      const h = document.createElement('div');
      h.textContent = 'üíñ';
      h.className = 'heart-fall';
      h.style.left = Math.random()*100 + 'vw';
      document.body.appendChild(h);
      setTimeout(()=>h.remove(), 3000);
    }

    function rainHearts(n=25) {
      for(let i=0; i<n; i++){
        setTimeout(createFallingHeart, i*100);
      }
    }

    function updateTimer(){
      const now = Date.now();
      let diff = now - startDate;
      if(diff<0){
        timerEl.textContent = '–°–∫–æ—Ä–æ –Ω–∞—á–∞–ª–æ –Ω–∞—à–µ–π –∏—Å—Ç–æ—Ä–∏–∏!';
        return;
      }
      const days    = Math.floor(diff/86400000);
      const hours   = Math.floor(diff/3600000)%24;
      const mins    = Math.floor(diff/60000)%60;
      const secs    = Math.floor(diff/1000)%60;
      timerEl.textContent = 
        `–í–º–µ—Å—Ç–µ —É–∂–µ: ${days} –¥–Ω. ${hours} —á. ${mins} –º–∏–Ω. ${secs} —Å–µ–∫.`;
    }

    let sceneStarted = false;

    function showPhrases(i=0){
      message.textContent = phrases[i]||'';
      setTimeout(
        ()=>showPhrases((i+1)%phrases.length),
        4000
      );
    }

    // –§–µ–π–µ—Ä–≤–µ—Ä–∫–∏
    canvas.width = innerWidth; canvas.height = innerHeight;
    let particles = [];

    function random(min,max){ return Math.random()*(max-min)+min; }

    function createFirework(){
      const x = random(100,innerWidth-100);
      const y = random(50,innerHeight/2);
      const color = `hsl(${~~random(0,360)},100%,60%)`;
      for(let i=0;i<25;i++){
        const ang = 2*Math.PI/25*i;
        const speed = random(2,5);
        particles.push({
          x,y,
          dx: Math.cos(ang)*speed,
          dy: Math.sin(ang)*speed,
          life:100,
          color
        });
      }
    }

    function updateFireworks(){
      ctx.clearRect(0,0,innerWidth,innerHeight);
      for(let i=particles.length-1;i>=0;i--){
        const p = particles[i];
        p.x+=p.dx; p.y+=p.dy; p.dy+=0.05; p.life--;
        if(p.life<=0) particles.splice(i,1);
        else{
          ctx.beginPath();
          ctx.arc(p.x,p.y,2,0,2*Math.PI);
          ctx.fillStyle = p.color;
          ctx.fill();
        }
      }
    }

    function loopFW(){
      if(Math.random()<0.1) createFirework();
      updateFireworks();
      requestAnimationFrame(loopFW);
    }

    // –ó–∞–ø—É—Å–∫ —Å—Ü–µ–Ω—ã
    heart.addEventListener('click', ()=>{
      if(sceneStarted) return;
      sceneStarted = true;

      hint.style.display    = 'none';
      birthday.style.display= 'block';
      message.style.display = 'block';
      timerEl.style.display = 'block';
      letterCont.style.display = 'block';

      rainHearts(35);
      showPhrases();
      updateTimer();
      setInterval(updateTimer,1000);

      canvas.style.display = 'block';
      loopFW();
    });

    // –ü–∏—Å—å–º–æ
    emojiEnv.addEventListener('click', ()=>{
      sliding.style.height = sliding.scrollHeight+'px';
    });

    // –ü—Ä–∏ —Ä–µ—Å–∞–π–∑–µ
    window.addEventListener('resize', ()=>{
      canvas.width = innerWidth;
      canvas.height = innerHeight;
    });
  </script>
</body>
</html>
